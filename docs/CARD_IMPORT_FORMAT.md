# 卡牌导入格式说明

## 概述

本系统支持通过Excel或CSV文件批量导入卡牌数据。导入的卡牌会自动生成并添加到对应的阶段或随机事件库中。

## 文件格式

支持的文件格式：
- Excel文件（.xlsx, .xls）
- CSV文件（.csv）

## 表格字段说明

### 必填字段

| 字段名 | 说明 | 示例 |
|--------|------|------|
| **卡牌名称** | 卡牌的标题/名称 | `省城到山村` |
| **详细文本** | 卡牌的主要内容文本 | `"小张啊，关上门坐。"王副部长推了推眼镜...` |
| **左滑选项文本** | 左滑选项的文本内容 | `"请组织放心，我一定尽快打开局面。"` |
| **右滑选项文本** | 右滑选项的文本内容 | `"基层情况复杂，我会先当好学生。"` |

### 可选字段

| 字段名 | 说明 | 示例 |
|--------|------|------|
| **序号** | 卡牌序号（用于排序） | `1` |
| **卡牌类型** | `锚点卡` 或 `随机卡` | `锚点卡` |
| **触发时间** | 卡牌触发的时间描述 | `第1天`、`第2天` |
| **核心冲突摘要** | 卡牌的核心冲突描述 | `新任书记表态：迅速打开局面 vs 先当学生` |
| **关键人物** | 卡牌中出现的主要人物 | `县委组织部副部长` |
| **涉及核心维度** | 涉及的维度标签 | `民生 vs 经济` |
| **左滑选项影响** | 左滑选项对游戏数值的影响 | `民生-10` |
| **右滑选项影响** | 右滑选项对游戏数值的影响 | `经济-10` |
| **阶段名称** | 指定锚点卡添加到哪个阶段 | `第一阶段：云岭三十日` |

## 选项影响格式

选项影响字段使用以下格式：

```
维度名+数值，维度名-数值
```

### 支持的维度

- **经济** → 对应游戏中的 `economy`
- **民生** → 对应游戏中的 `people`
- **生态** → 对应游戏中的 `environment`
- **乡风** → 对应游戏中的 `civility`

### 示例

```
经济+10，民生-10
生态+5，经济-10，乡风+5
民生+10，经济-10，乡风+5
```

## 卡牌类型说明

### 锚点卡

- 添加到指定的游戏阶段中
- 如果指定了`阶段名称`，会添加到对应阶段
- 如果未指定，会添加到第一个阶段
- 如果指定的阶段不存在，会创建新阶段

### 随机卡

- 添加到随机事件库（`randomEventLibrary`）中
- 在游戏过程中随机触发

## NPC处理

- 系统会根据`关键人物`字段自动创建或匹配NPC
- 如果NPC已存在（根据名称匹配），会复用现有NPC
- 如果NPC不存在，会自动创建新NPC，使用默认头像
- 创建的新NPC可以在编辑器中手动调整头像和详细信息

## 导入流程

1. 准备Excel/CSV文件，确保包含所有必填字段
2. 在编辑器中点击"导入卡牌"按钮
3. 选择文件并上传
4. 系统自动解析并验证数据
5. 显示导入结果（成功数量、错误信息等）
6. 导入的卡牌会自动添加到配置中

## 示例数据

```csv
序号,卡牌类型,触发时间,卡牌名称,核心冲突摘要,关键人物,涉及核心维度,详细文本,左滑选项文本,左滑选项影响,右滑选项文本,右滑选项影响,阶段名称
1,锚点卡,第1天,省城到山村,新任书记表态：迅速打开局面 vs 先当学生,县委组织部副部长,民生 vs 经济,"小张啊，关上门坐。王副部长推了推眼镜，这次选派你去云岭村，是县委反复考虑的结果。","请组织放心，我一定尽快打开局面。",民生-10,"基层情况复杂，我会先当好学生。",经济-10,第一阶段：云岭三十日
2,随机卡,,进门酒,接风习俗：严守纪律 vs 入乡随俗,寨老黄公,乡风 vs (经济、民生),寨老黄公：按寨子规矩，新来的带头人要喝三碗'进门酒'。,"心意领了，以茶代酒。",乡风-10,"规矩我懂，喝一碗表心意。",乡风+5,
```

## 注意事项

1. **文件编码**：CSV文件请使用UTF-8编码，避免中文乱码
2. **字段顺序**：字段顺序可以任意，但字段名必须准确
3. **数值格式**：选项影响中的数值必须是整数，支持正负数
4. **文本格式**：文本字段中的引号会被保留，支持多行文本
5. **错误处理**：如果某行数据有错误，会跳过该行并显示错误信息，其他行仍会正常导入
6. **重复导入**：可以多次导入，系统会自动合并数据

## 常见问题

### Q: 导入后卡牌在哪里？
A: 锚点卡会添加到指定的阶段，随机卡会添加到随机事件库。可以在编辑器的阶段列表中查看。

### Q: 如何修改导入的卡牌？
A: 导入后可以在编辑器中像编辑其他卡牌一样进行修改。

### Q: NPC头像如何设置？
A: 导入时使用默认头像，可以在编辑器的资源库中手动修改NPC的头像。

### Q: 支持批量修改吗？
A: 目前不支持批量修改，但可以重新导入覆盖数据（注意：会创建新的卡牌，不会删除旧的）。

### Q: 选项影响可以留空吗？
A: 可以，留空表示该选项不影响游戏数值。

